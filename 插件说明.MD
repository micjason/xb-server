# 插件使用说明

## dotenv

### 简介
`dotenv` 是一个零依赖的模块，用于将环境变量从 `.env` 文件加载到 `process.env` 中。它能够帮助我们管理应用程序的配置，特别是一些敏感信息（如数据库密码、API密钥等）。

### 安装
```bash
npm install dotenv
```

### 基本用法

1. **创建 .env 文件**
```env
# 服务器配置
NODE_ENV=development
PORT=3000

# 数据库配置
MONGODB_URI=mongodb://localhost:27017/XUBU_DB
```

2. **在应用入口文件（如 app.js）中引入**
```javascript
require('dotenv').config();
```

3. **使用环境变量**
```javascript
// 获取环境变量
const port = process.env.PORT || 3000;
const dbUri = process.env.MONGODB_URI;

console.log(`服务器运行在端口 ${port}`);
console.log(`数据库连接地址: ${dbUri}`);
```

### 最佳实践

1. **永远不要提交 .env 文件到版本控制**
- 在 `.gitignore` 中添加 `.env`
- 提供一个 `.env.example` 作为模板

2. **使用默认值**
```javascript
// 如果环境变量不存在，使用默认值
const port = process.env.PORT || 3000;
```

3. **在配置文件中集中管理**
```javascript
// config/config.js
module.exports = {
    mongodb: {
        url: process.env.MONGODB_URI || 'mongodb://localhost:27017/XUBU_DB'
    }
};
```

### 环境变量命名建议

1. **使用大写字母和下划线**
```env
DATABASE_URL=mongodb://localhost:27017/db
API_KEY=your-api-key
```

2. **使用有意义的前缀分组相关变量**
```env
DB_HOST=localhost
DB_PORT=27017
DB_NAME=myapp

REDIS_HOST=localhost
REDIS_PORT=6379
```

### 注意事项

1. `.env` 文件应该放在项目根目录
2. 环境变量值不需要引号，除非包含空格
3. 每行一个环境变量
4. 可以使用 `#` 添加注释
5. 不要在 `.env` 文件中存储敏感信息（生产环境）

### 在不同环境中使用不同的配置

可以为不同环境创建不同的 `.env` 文件：
- `.env.development`
- `.env.test`
- `.env.production`

然后根据 `NODE_ENV` 加载相应的文件：
```javascript
require('dotenv').config({
    path: `.env.${process.env.NODE_ENV}`
});
```

### 调试技巧

如果环境变量没有正确加载，可以：

1. 确认 `dotenv` 是在最早被引入的
2. 打印 `process.env` 查看所有环境变量
```javascript
console.log('环境变量:', process.env);
```

### 实际应用示例

在我们的项目中的使用：
```javascript
// app.js
require('dotenv').config();

// 使用环境变量启动服务器
const PORT = process.env.PORT || 3000;
app.listen(PORT, () => {
    console.log(`服务器运行在端口 ${PORT}`);
});

// 使用环境变量连接数据库
mongoose.connect(process.env.MONGODB_URI)
    .then(() => console.log('数据库连接成功'))
    .catch(err => console.log('数据库连接失败:', err));
```
